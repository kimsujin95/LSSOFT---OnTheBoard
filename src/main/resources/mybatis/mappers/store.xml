<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="store">

	<!-- 매장 리스트 불러오기 -->
	<select id="list" resultType="com.otb.vo.StoreVo">
		<![CDATA[
			select store_no as storeNo,
				   store_name as storeName,
				   store_latitude as storeLat,
				   store_longitude as storeLng
			from store
		]]>
	</select>
	
	<!-- 매장 검색 리스트 불러오기 -->
	<select id="searchList" parameterType="String" resultType="com.otb.vo.StoreVo">
		<![CDATA[
			select store_no as storeNo,
				   store_name as storeName,
				   store_latitude as storeLat,
				   store_longitude as storeLng
			from store
		]]>
		<if test=" value != null and value != '' ">
		<![CDATA[
			where store_name like '%'||#{keyword}||'%'
		]]>
		</if>
	</select>

	<!-- 로그인 한 사용자의 정보로 그룹리스트 가져오기 -->
	<select id="getgrouplist" parameterType="int" resultType="com.otb.vo.UserVo">
		<![CDATA[
			select mg.user_no as userNo,
      			   u.user_nickname as userNickname
			from matching_group mg, users u
			where mg.user_no = u.user_no and
      			  mg.matching_no = #{matchingno}
		]]>
	</select>
	
	<!-- 매장정보 가져오기 -->
	<select id="getstoreInfo" parameterType="int" resultType="StoreVo">
		<![CDATA[
			select store_description as storeDesc,
				   store_name as storeName,
       			   store_phone_no as storePhoneNo,
       			   store_charge_week as storeChargeWeek,
       			   store_charge_weekend as storeChargeWeekend,
      			   store_address_road as storeAddressRoad,
       			   store_address_detail as storeAddressDetail
			from store
			where store_no = #{storeNo} 
		]]>
	</select>
	
	
	<!-- 매장번호, 날짜데이터로 예약날짜번호값 가져오기 -->
	<select id="getDateInfo" parameterType="ReservationDateVo" resultType="int">
		<![CDATA[
			select reservation_date_no as reservationDateNo
			from reservation_date
			where store_no = #{storeNo} and store_reservation_date = #{storeReservationDate}
		]]>
	</select>	
	
	<!-- 매장 예약가능 시간 리스트 가져오기 -->
	<select id="getStoreRevTime" parameterType="int" resultType="ReservationTimeVo">
		<![CDATA[
			select reservation_date_no as  reservationDateNo,
				   store_reservation_time as storeReservationTime
			from reservation_time
			where reservation_date_no = #{reservationDateNo}
			order by store_reservation_time asc
		]]>
	</select>
</mapper>